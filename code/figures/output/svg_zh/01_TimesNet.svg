<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 900" width="800" height="900">
  <defs>
    <!-- 统一样式定义 -->
    <style>
      .title { font: bold 24px Arial, SimHei, sans-serif; fill: #1a1a2e; }
      .subtitle { font: 14px Arial, SimSun, sans-serif; fill: #666; }
      .module-text { font: bold 14px Arial, SimHei, sans-serif; fill: white; }
      .module-text-dark { font: bold 14px Arial, SimHei, sans-serif; fill: #333; }
      .detail-text { font: 12px Arial, SimSun, sans-serif; fill: #555; }
      .arrow-text { font: 11px Arial, SimSun, sans-serif; fill: #888; }
    </style>
    <!-- 箭头标记 -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <!-- 渐变定义 -->
    <linearGradient id="inputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#388E3C;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="coreGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="innovationGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#F57C00;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9C27B0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7B1FA2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="normGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#78909C;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#546E7A;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- 背景 -->
  <rect width="800" height="900" fill="#fafafa"/>

  <!-- 标题 -->
  <text x="400" y="40" text-anchor="middle" class="title">TimesNet</text>
  <text x="400" y="65" text-anchor="middle" class="subtitle">FFT周期发现 + 二维卷积 | ICLR 2023 | 约470万参数</text>

  <!-- 输入层 -->
  <rect x="250" y="90" width="300" height="50" rx="8" fill="url(#inputGrad)"/>
  <text x="400" y="120" text-anchor="middle" class="module-text">输入: [B, T, C]</text>

  <!-- 箭头 -->
  <line x1="400" y1="140" x2="400" y2="165" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Instance Normalization -->
  <rect x="250" y="170" width="300" height="45" rx="8" fill="url(#normGrad)"/>
  <text x="400" y="197" text-anchor="middle" class="module-text">实例归一化</text>

  <line x1="400" y1="215" x2="400" y2="240" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Data Embedding -->
  <rect x="250" y="245" width="300" height="45" rx="8" fill="url(#coreGrad)"/>
  <text x="400" y="272" text-anchor="middle" class="module-text">数据嵌入</text>
  <text x="560" y="272" class="detail-text">[B,T,C]→[B,T,d]</text>

  <line x1="400" y1="290" x2="400" y2="315" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- TimesBlock 主框 -->
  <rect x="100" y="320" width="600" height="420" rx="12" fill="none" stroke="#FF9800" stroke-width="3" stroke-dasharray="8,4"/>
  <text x="120" y="345" class="subtitle" fill="#FF9800">时序块 × e_layers层</text>

  <!-- FFT Period Discovery -->
  <rect x="250" y="360" width="300" height="50" rx="8" fill="url(#innovationGrad)"/>
  <text x="400" y="390" text-anchor="middle" class="module-text">FFT周期发现</text>
  <text x="560" y="390" class="detail-text">Top-K周期</text>

  <line x1="400" y1="410" x2="400" y2="435" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 多周期并行分支 -->
  <rect x="130" y="440" width="540" height="140" rx="8" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="400" y="465" text-anchor="middle" class="module-text-dark">多周期并行分支</text>

  <!-- Period 1 -->
  <rect x="150" y="480" width="100" height="80" rx="6" fill="url(#coreGrad)"/>
  <text x="200" y="510" text-anchor="middle" class="module-text" font-size="11">周期 1</text>
  <text x="200" y="530" text-anchor="middle" class="module-text" font-size="10">1D→2D</text>
  <text x="200" y="548" text-anchor="middle" class="module-text" font-size="10">二维卷积</text>

  <!-- Period 2 -->
  <rect x="270" y="480" width="100" height="80" rx="6" fill="url(#coreGrad)"/>
  <text x="320" y="510" text-anchor="middle" class="module-text" font-size="11">周期 2</text>
  <text x="320" y="530" text-anchor="middle" class="module-text" font-size="10">1D→2D</text>
  <text x="320" y="548" text-anchor="middle" class="module-text" font-size="10">二维卷积</text>

  <!-- ... -->
  <text x="400" y="520" text-anchor="middle" class="module-text-dark" font-size="20">...</text>

  <!-- Period K -->
  <rect x="430" y="480" width="100" height="80" rx="6" fill="url(#coreGrad)"/>
  <text x="480" y="510" text-anchor="middle" class="module-text" font-size="11">周期 K</text>
  <text x="480" y="530" text-anchor="middle" class="module-text" font-size="10">1D→2D</text>
  <text x="480" y="548" text-anchor="middle" class="module-text" font-size="10">二维卷积</text>

  <!-- Inception说明 -->
  <rect x="550" y="480" width="110" height="80" rx="6" fill="#FFF3E0" stroke="#FF9800" stroke-width="1"/>
  <text x="605" y="505" text-anchor="middle" class="detail-text" fill="#E65100">Inception</text>
  <text x="605" y="522" text-anchor="middle" class="detail-text" fill="#E65100">模块 V1</text>
  <text x="605" y="542" text-anchor="middle" class="detail-text" fill="#888">1×1,3×3,5×5</text>
  <text x="605" y="556" text-anchor="middle" class="detail-text" fill="#888">卷积核</text>

  <line x1="400" y1="580" x2="400" y2="605" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Adaptive Aggregation -->
  <rect x="250" y="610" width="300" height="50" rx="8" fill="url(#innovationGrad)"/>
  <text x="400" y="640" text-anchor="middle" class="module-text">自适应聚合</text>
  <text x="560" y="640" class="detail-text">Softmax权重</text>

  <line x1="400" y1="660" x2="400" y2="685" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Residual -->
  <rect x="300" y="690" width="200" height="35" rx="6" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="400" y="712" text-anchor="middle" class="module-text-dark">残差连接: out + x</text>

  <!-- 箭头出 TimesBlock -->
  <line x1="400" y1="740" x2="400" y2="765" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Output Projection -->
  <rect x="250" y="770" width="300" height="45" rx="8" fill="url(#coreGrad)"/>
  <text x="400" y="797" text-anchor="middle" class="module-text">输出投影</text>
  <text x="560" y="797" class="detail-text">[B,T,d]→[B,T,C]</text>

  <line x1="400" y1="815" x2="400" y2="840" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 输出 -->
  <rect x="250" y="845" width="300" height="45" rx="8" fill="url(#outputGrad)"/>
  <text x="400" y="872" text-anchor="middle" class="module-text">输出: [B, T, C]</text>

  <!-- 图例 -->
  <rect x="620" y="90" width="160" height="130" rx="8" fill="white" stroke="#ddd" stroke-width="1"/>
  <text x="700" y="110" text-anchor="middle" class="detail-text" font-weight="bold">图例</text>
  <rect x="630" y="120" width="20" height="12" rx="3" fill="url(#inputGrad)"/>
  <text x="660" y="130" class="detail-text">输入/输出</text>
  <rect x="630" y="140" width="20" height="12" rx="3" fill="url(#coreGrad)"/>
  <text x="660" y="150" class="detail-text">核心模块</text>
  <rect x="630" y="160" width="20" height="12" rx="3" fill="url(#innovationGrad)"/>
  <text x="660" y="170" class="detail-text">创新模块</text>
  <rect x="630" y="180" width="20" height="12" rx="3" fill="url(#normGrad)"/>
  <text x="660" y="190" class="detail-text">归一化</text>
  <rect x="630" y="200" width="20" height="12" rx="3" fill="#E8F5E9" stroke="#4CAF50"/>
  <text x="660" y="210" class="detail-text">残差连接</text>
</svg>
