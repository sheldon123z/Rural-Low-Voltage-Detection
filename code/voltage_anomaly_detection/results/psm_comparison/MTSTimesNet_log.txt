Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           PSM_MTSTimesNet     Model:              MTSTimesNet         

[1mData Loader[0m
  Data:               PSM                 Root Path:          ./dataset/PSM/      
  Features:           M                   Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Seq Len:            100                 Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             25                  C Out:              25                  
  d model:            64                  d FF:               64                  
  n heads:            8                   e layers:           2                   
  Dropout:            0.1                 Embed:              timeF               

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

Use GPU: cuda:0
>>>>>>>>>> Training: PSM_MTSTimesNet_MTSTimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
train 132382
test: (87841, 25)
train: (132481, 25)
val 26398
test: (87841, 25)
train: (132481, 25)
test 87742
	iters: 100, epoch: 1 | loss: 0.0534736
	speed: 0.1636s/iter; left time: 1676.8560s
	iters: 200, epoch: 1 | loss: 0.0314878
	speed: 0.1349s/iter; left time: 1369.5867s
	iters: 300, epoch: 1 | loss: 0.0368399
	speed: 0.1338s/iter; left time: 1344.9138s
	iters: 400, epoch: 1 | loss: 0.0254605
	speed: 0.1349s/iter; left time: 1342.1334s
	iters: 500, epoch: 1 | loss: 0.0299961
	speed: 0.1341s/iter; left time: 1320.8709s
	iters: 600, epoch: 1 | loss: 0.0199607
	speed: 0.1328s/iter; left time: 1294.4886s
	iters: 700, epoch: 1 | loss: 0.0124032
	speed: 0.1325s/iter; left time: 1278.9945s
	iters: 800, epoch: 1 | loss: 0.0116342
	speed: 0.1327s/iter; left time: 1267.3773s
	iters: 900, epoch: 1 | loss: 0.0153529
	speed: 0.1338s/iter; left time: 1264.1121s
	iters: 1000, epoch: 1 | loss: 0.0097115
	speed: 0.1337s/iter; left time: 1250.6851s
Epoch: 1 cost time: 140.37366485595703
Epoch: 1, Steps: 1035 | Train Loss: 0.0278717 Vali Loss: 0.0092893 Test Loss: 0.0172716
Validation loss decreased (inf --> 0.009289).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0080880
	speed: 0.6004s/iter; left time: 5533.3363s
	iters: 200, epoch: 2 | loss: 0.0135517
	speed: 0.1346s/iter; left time: 1227.2557s
	iters: 300, epoch: 2 | loss: 0.0093990
	speed: 0.1321s/iter; left time: 1191.1795s
	iters: 400, epoch: 2 | loss: 0.0095225
	speed: 0.1322s/iter; left time: 1178.2746s
	iters: 500, epoch: 2 | loss: 0.0096114
	speed: 0.1324s/iter; left time: 1167.3253s
	iters: 600, epoch: 2 | loss: 0.0099551
	speed: 0.1322s/iter; left time: 1152.3102s
	iters: 700, epoch: 2 | loss: 0.0078176
	speed: 0.1328s/iter; left time: 1144.5639s
	iters: 800, epoch: 2 | loss: 0.0070483
	speed: 0.1354s/iter; left time: 1152.6433s
	iters: 900, epoch: 2 | loss: 0.0062018
	speed: 0.1350s/iter; left time: 1136.5083s
	iters: 1000, epoch: 2 | loss: 0.0067165
	speed: 0.1336s/iter; left time: 1111.0778s
Epoch: 2 cost time: 138.86211681365967
Epoch: 2, Steps: 1035 | Train Loss: 0.0099866 Vali Loss: 0.0051942 Test Loss: 0.0107003
Validation loss decreased (0.009289 --> 0.005194).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0115806
	speed: 0.5560s/iter; left time: 4549.0314s
	iters: 200, epoch: 3 | loss: 0.0069813
	speed: 0.1318s/iter; left time: 1065.0037s
	iters: 300, epoch: 3 | loss: 0.0081488
	speed: 0.1315s/iter; left time: 1049.2390s
	iters: 400, epoch: 3 | loss: 0.0065487
	speed: 0.1321s/iter; left time: 1041.1486s
	iters: 500, epoch: 3 | loss: 0.0057477
	speed: 0.1327s/iter; left time: 1032.4676s
	iters: 600, epoch: 3 | loss: 0.0065446
	speed: 0.1329s/iter; left time: 1021.1204s
	iters: 700, epoch: 3 | loss: 0.0074449
	speed: 0.1332s/iter; left time: 1010.1064s
	iters: 800, epoch: 3 | loss: 0.0058014
	speed: 0.1334s/iter; left time: 997.7809s
	iters: 900, epoch: 3 | loss: 0.0068231
	speed: 0.1327s/iter; left time: 979.7589s
	iters: 1000, epoch: 3 | loss: 0.0062353
	speed: 0.1327s/iter; left time: 966.4725s
Epoch: 3 cost time: 137.4692418575287
Epoch: 3, Steps: 1035 | Train Loss: 0.0067971 Vali Loss: 0.0035306 Test Loss: 0.0085771
Validation loss decreased (0.005194 --> 0.003531).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0051491
	speed: 0.5635s/iter; left time: 4026.9693s
	iters: 200, epoch: 4 | loss: 0.0047738
	speed: 0.1320s/iter; left time: 930.0273s
	iters: 300, epoch: 4 | loss: 0.0050868
	speed: 0.1316s/iter; left time: 914.4305s
	iters: 400, epoch: 4 | loss: 0.0048820
	speed: 0.1319s/iter; left time: 902.7532s
	iters: 500, epoch: 4 | loss: 0.0054432
	speed: 0.1328s/iter; left time: 896.1751s
	iters: 600, epoch: 4 | loss: 0.0060328
	speed: 0.1340s/iter; left time: 890.8227s
	iters: 700, epoch: 4 | loss: 0.0056236
	speed: 0.1326s/iter; left time: 867.8634s
	iters: 800, epoch: 4 | loss: 0.0053306
	speed: 0.1351s/iter; left time: 871.0647s
	iters: 900, epoch: 4 | loss: 0.0046950
	speed: 0.1321s/iter; left time: 838.3115s
	iters: 1000, epoch: 4 | loss: 0.0070271
	speed: 0.1321s/iter; left time: 824.8779s
Epoch: 4 cost time: 137.96161031723022
Epoch: 4, Steps: 1035 | Train Loss: 0.0057802 Vali Loss: 0.0038346 Test Loss: 0.0085799
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0047782
	speed: 0.5502s/iter; left time: 3362.3121s
	iters: 200, epoch: 5 | loss: 0.0058281
	speed: 0.1317s/iter; left time: 791.4209s
	iters: 300, epoch: 5 | loss: 0.0040716
	speed: 0.1316s/iter; left time: 777.6003s
	iters: 400, epoch: 5 | loss: 0.0059934
	speed: 0.1315s/iter; left time: 764.2729s
	iters: 500, epoch: 5 | loss: 0.0047426
	speed: 0.1314s/iter; left time: 750.1594s
	iters: 600, epoch: 5 | loss: 0.0049359
	speed: 0.1315s/iter; left time: 738.0397s
	iters: 700, epoch: 5 | loss: 0.0053934
	speed: 0.1316s/iter; left time: 725.3330s
	iters: 800, epoch: 5 | loss: 0.0050910
	speed: 0.1318s/iter; left time: 713.0228s
	iters: 900, epoch: 5 | loss: 0.0044176
	speed: 0.1321s/iter; left time: 701.3828s
	iters: 1000, epoch: 5 | loss: 0.0045131
	speed: 0.1322s/iter; left time: 689.0850s
Epoch: 5 cost time: 136.74225211143494
Epoch: 5, Steps: 1035 | Train Loss: 0.0053530 Vali Loss: 0.0027799 Test Loss: 0.0071897
Validation loss decreased (0.003531 --> 0.002780).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0068472
	speed: 0.5663s/iter; left time: 2874.6381s
	iters: 200, epoch: 6 | loss: 0.0048905
	speed: 0.1323s/iter; left time: 658.5238s
	iters: 300, epoch: 6 | loss: 0.0047073
	speed: 0.1300s/iter; left time: 633.6763s
	iters: 400, epoch: 6 | loss: 0.0056274
	speed: 0.1316s/iter; left time: 628.5822s
	iters: 500, epoch: 6 | loss: 0.0081418
	speed: 0.1316s/iter; left time: 615.2551s
	iters: 600, epoch: 6 | loss: 0.0070283
	speed: 0.1317s/iter; left time: 602.6731s
	iters: 700, epoch: 6 | loss: 0.0058728
	speed: 0.1321s/iter; left time: 591.4553s
	iters: 800, epoch: 6 | loss: 0.0080225
	speed: 0.1313s/iter; left time: 574.6122s
	iters: 900, epoch: 6 | loss: 0.0042502
	speed: 0.1314s/iter; left time: 561.9716s
	iters: 1000, epoch: 6 | loss: 0.0053233
	speed: 0.1319s/iter; left time: 550.6652s
Epoch: 6 cost time: 136.54278945922852
Epoch: 6, Steps: 1035 | Train Loss: 0.0051263 Vali Loss: 0.0026400 Test Loss: 0.0069219
Validation loss decreased (0.002780 --> 0.002640).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0056739
	speed: 0.5681s/iter; left time: 2295.7977s
	iters: 200, epoch: 7 | loss: 0.0043733
	speed: 0.1317s/iter; left time: 519.0611s
	iters: 300, epoch: 7 | loss: 0.0047943
	speed: 0.1316s/iter; left time: 505.5759s
	iters: 400, epoch: 7 | loss: 0.0048221
	speed: 0.1317s/iter; left time: 492.7575s
	iters: 500, epoch: 7 | loss: 0.0049650
	speed: 0.1331s/iter; left time: 484.4921s
	iters: 600, epoch: 7 | loss: 0.0055304
	speed: 0.1319s/iter; left time: 467.0692s
	iters: 700, epoch: 7 | loss: 0.0043201
	speed: 0.1319s/iter; left time: 453.8648s
	iters: 800, epoch: 7 | loss: 0.0045131
	speed: 0.1336s/iter; left time: 446.4326s
	iters: 900, epoch: 7 | loss: 0.0046798
	speed: 0.1364s/iter; left time: 441.9492s
	iters: 1000, epoch: 7 | loss: 0.0053871
	speed: 0.1294s/iter; left time: 406.3932s
Epoch: 7 cost time: 137.9904854297638
Epoch: 7, Steps: 1035 | Train Loss: 0.0050071 Vali Loss: 0.0025762 Test Loss: 0.0068043
Validation loss decreased (0.002640 --> 0.002576).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0046522
	speed: 0.5827s/iter; left time: 1751.7174s
	iters: 200, epoch: 8 | loss: 0.0058442
	speed: 0.1389s/iter; left time: 403.5567s
	iters: 300, epoch: 8 | loss: 0.0048480
	speed: 0.1399s/iter; left time: 392.4781s
	iters: 400, epoch: 8 | loss: 0.0054101
	speed: 0.1391s/iter; left time: 376.3511s
	iters: 500, epoch: 8 | loss: 0.0044914
	speed: 0.1365s/iter; left time: 355.5976s
	iters: 600, epoch: 8 | loss: 0.0055131
	speed: 0.1346s/iter; left time: 337.2364s
	iters: 700, epoch: 8 | loss: 0.0053007
	speed: 0.1350s/iter; left time: 324.9160s
	iters: 800, epoch: 8 | loss: 0.0050393
	speed: 0.1326s/iter; left time: 305.8506s
	iters: 900, epoch: 8 | loss: 0.0035608
	speed: 0.1324s/iter; left time: 292.1595s
	iters: 1000, epoch: 8 | loss: 0.0086609
	speed: 0.1323s/iter; left time: 278.6625s
Epoch: 8 cost time: 141.64473390579224
Epoch: 8, Steps: 1035 | Train Loss: 0.0049445 Vali Loss: 0.0025545 Test Loss: 0.0067582
Validation loss decreased (0.002576 --> 0.002555).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0048117
	speed: 0.5608s/iter; left time: 1105.2513s
	iters: 200, epoch: 9 | loss: 0.0053821
	speed: 0.1319s/iter; left time: 246.6946s
	iters: 300, epoch: 9 | loss: 0.0046065
	speed: 0.1322s/iter; left time: 234.0586s
	iters: 400, epoch: 9 | loss: 0.0037129
	speed: 0.1321s/iter; left time: 220.8161s
	iters: 500, epoch: 9 | loss: 0.0048871
	speed: 0.1323s/iter; left time: 207.8515s
	iters: 600, epoch: 9 | loss: 0.0052113
	speed: 0.1320s/iter; left time: 194.1709s
	iters: 700, epoch: 9 | loss: 0.0051138
	speed: 0.1324s/iter; left time: 181.4690s
	iters: 800, epoch: 9 | loss: 0.0043871
	speed: 0.1326s/iter; left time: 168.5169s
	iters: 900, epoch: 9 | loss: 0.0051825
	speed: 0.1329s/iter; left time: 155.6479s
	iters: 1000, epoch: 9 | loss: 0.0059191
	speed: 0.1321s/iter; left time: 141.5026s
Epoch: 9 cost time: 137.3866844177246
Epoch: 9, Steps: 1035 | Train Loss: 0.0049126 Vali Loss: 0.0025359 Test Loss: 0.0066888
Validation loss decreased (0.002555 --> 0.002536).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0044526
	speed: 0.5581s/iter; left time: 522.4196s
	iters: 200, epoch: 10 | loss: 0.0051276
	speed: 0.1324s/iter; left time: 110.7185s
	iters: 300, epoch: 10 | loss: 0.0049661
	speed: 0.1321s/iter; left time: 97.2022s
	iters: 400, epoch: 10 | loss: 0.0044604
	speed: 0.1328s/iter; left time: 84.4292s
	iters: 500, epoch: 10 | loss: 0.0041947
	speed: 0.1324s/iter; left time: 70.9687s
	iters: 600, epoch: 10 | loss: 0.0037792
	speed: 0.1326s/iter; left time: 57.8150s
	iters: 700, epoch: 10 | loss: 0.0052307
	speed: 0.1323s/iter; left time: 44.4501s
	iters: 800, epoch: 10 | loss: 0.0037135
	speed: 0.1327s/iter; left time: 31.3220s
	iters: 900, epoch: 10 | loss: 0.0054727
	speed: 0.1329s/iter; left time: 18.0746s
	iters: 1000, epoch: 10 | loss: 0.0059024
	speed: 0.1339s/iter; left time: 4.8211s
Epoch: 10 cost time: 137.7534785270691
Epoch: 10, Steps: 1035 | Train Loss: 0.0048973 Vali Loss: 0.0025105 Test Loss: 0.0066794
Validation loss decreased (0.002536 --> 0.002510).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>>>> Testing: PSM_MTSTimesNet_MTSTimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
test 87742
test: (87841, 25)
train: (132481, 25)
train 132382
Threshold: 0.021615203
pred:    (8774200,)
gt:      (8774200,)
Accuracy: 0.9797, Precision: 0.9756, Recall: 0.9506, F1-score: 0.9629

