Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           PSM_VoltageTimesNet Model:              VoltageTimesNet     

[1mData Loader[0m
  Data:               PSM                 Root Path:          ./dataset/PSM/      
  Features:           M                   Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Seq Len:            100                 Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             25                  C Out:              25                  
  d model:            64                  d FF:               64                  
  n heads:            8                   e layers:           2                   
  Dropout:            0.1                 Embed:              timeF               

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

Use GPU: cuda:0
>>>>>>>>>> Training: PSM_VoltageTimesNet_VoltageTimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
train 132382
test: (87841, 25)
train: (132481, 25)
val 26398
test: (87841, 25)
train: (132481, 25)
test 87742
	iters: 100, epoch: 1 | loss: 0.0678960
	speed: 0.0913s/iter; left time: 935.5334s
	iters: 200, epoch: 1 | loss: 0.0369662
	speed: 0.0651s/iter; left time: 660.8615s
	iters: 300, epoch: 1 | loss: 0.0339062
	speed: 0.0662s/iter; left time: 665.1208s
	iters: 400, epoch: 1 | loss: 0.0302056
	speed: 0.0663s/iter; left time: 659.6381s
	iters: 500, epoch: 1 | loss: 0.0457059
	speed: 0.0679s/iter; left time: 669.1669s
	iters: 600, epoch: 1 | loss: 0.0263704
	speed: 0.0667s/iter; left time: 650.6687s
	iters: 700, epoch: 1 | loss: 0.0169189
	speed: 0.0673s/iter; left time: 649.0775s
	iters: 800, epoch: 1 | loss: 0.0184661
	speed: 0.0645s/iter; left time: 616.0952s
	iters: 900, epoch: 1 | loss: 0.0373352
	speed: 0.0629s/iter; left time: 594.8909s
	iters: 1000, epoch: 1 | loss: 0.0136432
	speed: 0.0626s/iter; left time: 585.4064s
Epoch: 1 cost time: 69.10024571418762
Epoch: 1, Steps: 1035 | Train Loss: 0.0382828 Vali Loss: 0.0143692 Test Loss: 0.0206805
Validation loss decreased (inf --> 0.014369).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0161866
	speed: 0.2232s/iter; left time: 2057.4199s
	iters: 200, epoch: 2 | loss: 0.0121307
	speed: 0.0680s/iter; left time: 620.1584s
	iters: 300, epoch: 2 | loss: 0.0111838
	speed: 0.0627s/iter; left time: 565.4401s
	iters: 400, epoch: 2 | loss: 0.0118894
	speed: 0.0628s/iter; left time: 559.8238s
	iters: 500, epoch: 2 | loss: 0.0123985
	speed: 0.0621s/iter; left time: 547.5180s
	iters: 600, epoch: 2 | loss: 0.0126041
	speed: 0.0658s/iter; left time: 573.2553s
	iters: 700, epoch: 2 | loss: 0.0104353
	speed: 0.0656s/iter; left time: 564.9630s
	iters: 800, epoch: 2 | loss: 0.0114049
	speed: 0.0652s/iter; left time: 555.0916s
	iters: 900, epoch: 2 | loss: 0.0088392
	speed: 0.0631s/iter; left time: 530.7461s
	iters: 1000, epoch: 2 | loss: 0.0082920
	speed: 0.0635s/iter; left time: 528.0151s
Epoch: 2 cost time: 67.96956157684326
Epoch: 2, Steps: 1035 | Train Loss: 0.0135214 Vali Loss: 0.0075083 Test Loss: 0.0128689
Validation loss decreased (0.014369 --> 0.007508).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0087692
	speed: 0.2062s/iter; left time: 1686.7702s
	iters: 200, epoch: 3 | loss: 0.0090281
	speed: 0.0642s/iter; left time: 518.8827s
	iters: 300, epoch: 3 | loss: 0.0138494
	speed: 0.0635s/iter; left time: 506.5075s
	iters: 400, epoch: 3 | loss: 0.0101002
	speed: 0.0623s/iter; left time: 490.8154s
	iters: 500, epoch: 3 | loss: 0.0107497
	speed: 0.0640s/iter; left time: 497.8959s
	iters: 600, epoch: 3 | loss: 0.0106692
	speed: 0.0643s/iter; left time: 493.7033s
	iters: 700, epoch: 3 | loss: 0.0078988
	speed: 0.0652s/iter; left time: 494.3408s
	iters: 800, epoch: 3 | loss: 0.0106332
	speed: 0.0639s/iter; left time: 478.2026s
	iters: 900, epoch: 3 | loss: 0.0094726
	speed: 0.0669s/iter; left time: 494.1049s
	iters: 1000, epoch: 3 | loss: 0.0076049
	speed: 0.0664s/iter; left time: 483.7566s
Epoch: 3 cost time: 67.30249118804932
Epoch: 3, Steps: 1035 | Train Loss: 0.0094538 Vali Loss: 0.0056206 Test Loss: 0.0104172
Validation loss decreased (0.007508 --> 0.005621).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0069678
	speed: 0.2293s/iter; left time: 1638.2385s
	iters: 200, epoch: 4 | loss: 0.0075236
	speed: 0.0620s/iter; left time: 437.1981s
	iters: 300, epoch: 4 | loss: 0.0076222
	speed: 0.0628s/iter; left time: 436.2355s
	iters: 400, epoch: 4 | loss: 0.0078903
	speed: 0.0640s/iter; left time: 438.2596s
	iters: 500, epoch: 4 | loss: 0.0099659
	speed: 0.0623s/iter; left time: 420.0802s
	iters: 600, epoch: 4 | loss: 0.0077712
	speed: 0.0620s/iter; left time: 411.8884s
	iters: 700, epoch: 4 | loss: 0.0081833
	speed: 0.0602s/iter; left time: 394.0980s
	iters: 800, epoch: 4 | loss: 0.0066071
	speed: 0.0645s/iter; left time: 415.5984s
	iters: 900, epoch: 4 | loss: 0.0055030
	speed: 0.0620s/iter; left time: 393.1418s
	iters: 1000, epoch: 4 | loss: 0.0111641
	speed: 0.0630s/iter; left time: 393.4588s
Epoch: 4 cost time: 65.37890648841858
Epoch: 4, Steps: 1035 | Train Loss: 0.0080605 Vali Loss: 0.0048046 Test Loss: 0.0092788
Validation loss decreased (0.005621 --> 0.004805).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0101965
	speed: 0.1988s/iter; left time: 1214.8066s
	iters: 200, epoch: 5 | loss: 0.0059936
	speed: 0.0641s/iter; left time: 385.5488s
	iters: 300, epoch: 5 | loss: 0.0072777
	speed: 0.0633s/iter; left time: 374.2701s
	iters: 400, epoch: 5 | loss: 0.0070850
	speed: 0.0637s/iter; left time: 370.2792s
	iters: 500, epoch: 5 | loss: 0.0092765
	speed: 0.0555s/iter; left time: 317.1119s
	iters: 600, epoch: 5 | loss: 0.0051725
	speed: 0.0657s/iter; left time: 368.9057s
	iters: 700, epoch: 5 | loss: 0.0068458
	speed: 0.0658s/iter; left time: 362.8262s
	iters: 800, epoch: 5 | loss: 0.0081636
	speed: 0.0692s/iter; left time: 374.7070s
	iters: 900, epoch: 5 | loss: 0.0073702
	speed: 0.0683s/iter; left time: 362.9314s
	iters: 1000, epoch: 5 | loss: 0.0069869
	speed: 0.0638s/iter; left time: 332.5235s
Epoch: 5 cost time: 66.86773610115051
Epoch: 5, Steps: 1035 | Train Loss: 0.0074357 Vali Loss: 0.0044519 Test Loss: 0.0086783
Validation loss decreased (0.004805 --> 0.004452).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0056215
	speed: 0.2143s/iter; left time: 1087.6613s
	iters: 200, epoch: 6 | loss: 0.0073228
	speed: 0.0625s/iter; left time: 310.7892s
	iters: 300, epoch: 6 | loss: 0.0075175
	speed: 0.0662s/iter; left time: 322.5674s
	iters: 400, epoch: 6 | loss: 0.0068413
	speed: 0.0664s/iter; left time: 317.1435s
	iters: 500, epoch: 6 | loss: 0.0054572
	speed: 0.0666s/iter; left time: 311.2626s
	iters: 600, epoch: 6 | loss: 0.0084848
	speed: 0.0669s/iter; left time: 305.9245s
	iters: 700, epoch: 6 | loss: 0.0080463
	speed: 0.0663s/iter; left time: 296.9206s
	iters: 800, epoch: 6 | loss: 0.0071622
	speed: 0.0659s/iter; left time: 288.5894s
	iters: 900, epoch: 6 | loss: 0.0056571
	speed: 0.0647s/iter; left time: 276.6774s
	iters: 1000, epoch: 6 | loss: 0.0080266
	speed: 0.0697s/iter; left time: 291.0334s
Epoch: 6 cost time: 68.3228919506073
Epoch: 6, Steps: 1035 | Train Loss: 0.0071212 Vali Loss: 0.0042708 Test Loss: 0.0083883
Validation loss decreased (0.004452 --> 0.004271).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0054961
	speed: 0.2189s/iter; left time: 884.6349s
	iters: 200, epoch: 7 | loss: 0.0048788
	speed: 0.0651s/iter; left time: 256.4937s
	iters: 300, epoch: 7 | loss: 0.0077878
	speed: 0.0653s/iter; left time: 250.7141s
	iters: 400, epoch: 7 | loss: 0.0063479
	speed: 0.0658s/iter; left time: 246.1891s
	iters: 500, epoch: 7 | loss: 0.0057057
	speed: 0.0653s/iter; left time: 237.6487s
	iters: 600, epoch: 7 | loss: 0.0066136
	speed: 0.0660s/iter; left time: 233.6960s
	iters: 700, epoch: 7 | loss: 0.0064246
	speed: 0.0656s/iter; left time: 225.7306s
	iters: 800, epoch: 7 | loss: 0.0074285
	speed: 0.0669s/iter; left time: 223.4825s
	iters: 900, epoch: 7 | loss: 0.0055144
	speed: 0.0668s/iter; left time: 216.3691s
	iters: 1000, epoch: 7 | loss: 0.0080252
	speed: 0.0679s/iter; left time: 213.4142s
Epoch: 7 cost time: 69.1412193775177
Epoch: 7, Steps: 1035 | Train Loss: 0.0069575 Vali Loss: 0.0041495 Test Loss: 0.0082003
Validation loss decreased (0.004271 --> 0.004149).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0082544
	speed: 0.2223s/iter; left time: 668.1107s
	iters: 200, epoch: 8 | loss: 0.0061832
	speed: 0.0665s/iter; left time: 193.2918s
	iters: 300, epoch: 8 | loss: 0.0065435
	speed: 0.0670s/iter; left time: 188.0132s
	iters: 400, epoch: 8 | loss: 0.0071761
	speed: 0.0683s/iter; left time: 184.8294s
	iters: 500, epoch: 8 | loss: 0.0049195
	speed: 0.0665s/iter; left time: 173.3925s
	iters: 600, epoch: 8 | loss: 0.0087635
	speed: 0.0686s/iter; left time: 171.8185s
	iters: 700, epoch: 8 | loss: 0.0075199
	speed: 0.0701s/iter; left time: 168.7067s
	iters: 800, epoch: 8 | loss: 0.0059712
	speed: 0.0676s/iter; left time: 155.9658s
	iters: 900, epoch: 8 | loss: 0.0067584
	speed: 0.0676s/iter; left time: 149.0890s
	iters: 1000, epoch: 8 | loss: 0.0066100
	speed: 0.0638s/iter; left time: 134.2821s
Epoch: 8 cost time: 70.33914065361023
Epoch: 8, Steps: 1035 | Train Loss: 0.0068753 Vali Loss: 0.0040859 Test Loss: 0.0081023
Validation loss decreased (0.004149 --> 0.004086).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0052148
	speed: 0.1999s/iter; left time: 393.9958s
	iters: 200, epoch: 9 | loss: 0.0064597
	speed: 0.0635s/iter; left time: 118.7476s
	iters: 300, epoch: 9 | loss: 0.0059246
	speed: 0.0530s/iter; left time: 93.8222s
	iters: 400, epoch: 9 | loss: 0.0056419
	speed: 0.0470s/iter; left time: 78.4714s
	iters: 500, epoch: 9 | loss: 0.0071654
	speed: 0.0398s/iter; left time: 62.4931s
	iters: 600, epoch: 9 | loss: 0.0080433
	speed: 0.0414s/iter; left time: 60.8693s
	iters: 700, epoch: 9 | loss: 0.0059959
	speed: 0.0633s/iter; left time: 86.7236s
	iters: 800, epoch: 9 | loss: 0.0059891
	speed: 0.0648s/iter; left time: 82.3540s
	iters: 900, epoch: 9 | loss: 0.0063058
	speed: 0.0654s/iter; left time: 76.5496s
	iters: 1000, epoch: 9 | loss: 0.0053093
	speed: 0.0636s/iter; left time: 68.0951s
Epoch: 9 cost time: 58.935723066329956
Epoch: 9, Steps: 1035 | Train Loss: 0.0068318 Vali Loss: 0.0040712 Test Loss: 0.0080663
Validation loss decreased (0.004086 --> 0.004071).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0052131
	speed: 0.2042s/iter; left time: 191.1656s
	iters: 200, epoch: 10 | loss: 0.0098866
	speed: 0.0658s/iter; left time: 55.0352s
	iters: 300, epoch: 10 | loss: 0.0080619
	speed: 0.0659s/iter; left time: 48.5048s
	iters: 400, epoch: 10 | loss: 0.0056845
	speed: 0.0600s/iter; left time: 38.1306s
	iters: 500, epoch: 10 | loss: 0.0064510
	speed: 0.0605s/iter; left time: 32.4116s
	iters: 600, epoch: 10 | loss: 0.0059732
	speed: 0.0658s/iter; left time: 28.6948s
	iters: 700, epoch: 10 | loss: 0.0079466
	speed: 0.0674s/iter; left time: 22.6447s
	iters: 800, epoch: 10 | loss: 0.0095191
	speed: 0.0679s/iter; left time: 16.0153s
	iters: 900, epoch: 10 | loss: 0.0075404
	speed: 0.0668s/iter; left time: 9.0840s
	iters: 1000, epoch: 10 | loss: 0.0074825
	speed: 0.0663s/iter; left time: 2.3866s
Epoch: 10 cost time: 68.08802509307861
Epoch: 10, Steps: 1035 | Train Loss: 0.0068093 Vali Loss: 0.0040561 Test Loss: 0.0080449
Validation loss decreased (0.004071 --> 0.004056).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>>>> Testing: PSM_VoltageTimesNet_VoltageTimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
test 87742
test: (87841, 25)
train: (132481, 25)
train 132382
Threshold: 0.036935877
pred:    (8774200,)
gt:      (8774200,)
Accuracy: 0.9853, Precision: 0.9840, Recall: 0.9625, F1-score: 0.9731

