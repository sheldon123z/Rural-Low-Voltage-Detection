Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           PSM_TPATimesNet     Model:              TPATimesNet         

[1mData Loader[0m
  Data:               PSM                 Root Path:          ./dataset/PSM/      
  Features:           M                   Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Seq Len:            100                 Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             25                  C Out:              25                  
  d model:            64                  d FF:               64                  
  n heads:            8                   e layers:           2                   
  Dropout:            0.1                 Embed:              timeF               

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

Use GPU: cuda:0
>>>>>>>>>> Training: PSM_TPATimesNet_TPATimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
train 132382
test: (87841, 25)
train: (132481, 25)
val 26398
test: (87841, 25)
train: (132481, 25)
test 87742
	iters: 100, epoch: 1 | loss: 0.0723207
	speed: 0.0853s/iter; left time: 874.5917s
	iters: 200, epoch: 1 | loss: 0.0512149
	speed: 0.0664s/iter; left time: 673.5487s
	iters: 300, epoch: 1 | loss: 0.0356570
	speed: 0.0669s/iter; left time: 672.1984s
	iters: 400, epoch: 1 | loss: 0.0358803
	speed: 0.0655s/iter; left time: 651.9407s
	iters: 500, epoch: 1 | loss: 0.0331311
	speed: 0.0658s/iter; left time: 647.7573s
	iters: 600, epoch: 1 | loss: 0.0269997
	speed: 0.0660s/iter; left time: 643.5819s
	iters: 700, epoch: 1 | loss: 0.0293285
	speed: 0.0659s/iter; left time: 635.6622s
	iters: 800, epoch: 1 | loss: 0.0225394
	speed: 0.0666s/iter; left time: 635.7188s
	iters: 900, epoch: 1 | loss: 0.0192226
	speed: 0.0665s/iter; left time: 628.1541s
	iters: 1000, epoch: 1 | loss: 0.0177030
	speed: 0.0660s/iter; left time: 617.1513s
Epoch: 1 cost time: 69.73904156684875
Epoch: 1, Steps: 1035 | Train Loss: 0.0432545 Vali Loss: 0.0162163 Test Loss: 0.0230229
Validation loss decreased (inf --> 0.016216).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0166401
	speed: 0.2450s/iter; left time: 2258.2350s
	iters: 200, epoch: 2 | loss: 0.0226841
	speed: 0.0696s/iter; left time: 634.7216s
	iters: 300, epoch: 2 | loss: 0.0148114
	speed: 0.0698s/iter; left time: 629.0617s
	iters: 400, epoch: 2 | loss: 0.0145635
	speed: 0.0683s/iter; left time: 608.5702s
	iters: 500, epoch: 2 | loss: 0.0190282
	speed: 0.0655s/iter; left time: 577.3101s
	iters: 600, epoch: 2 | loss: 0.0122066
	speed: 0.0661s/iter; left time: 575.9961s
	iters: 700, epoch: 2 | loss: 0.0110760
	speed: 0.0672s/iter; left time: 578.7147s
	iters: 800, epoch: 2 | loss: 0.0121565
	speed: 0.0665s/iter; left time: 566.0805s
	iters: 900, epoch: 2 | loss: 0.0139389
	speed: 0.0659s/iter; left time: 554.5716s
	iters: 1000, epoch: 2 | loss: 0.0113579
	speed: 0.0654s/iter; left time: 543.9050s
Epoch: 2 cost time: 69.73069429397583
Epoch: 2, Steps: 1035 | Train Loss: 0.0148416 Vali Loss: 0.0086251 Test Loss: 0.0143208
Validation loss decreased (0.016216 --> 0.008625).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0084535
	speed: 0.2562s/iter; left time: 2096.3743s
	iters: 200, epoch: 3 | loss: 0.0100832
	speed: 0.0675s/iter; left time: 545.1135s
	iters: 300, epoch: 3 | loss: 0.0089700
	speed: 0.0671s/iter; left time: 535.1464s
	iters: 400, epoch: 3 | loss: 0.0096610
	speed: 0.0661s/iter; left time: 520.8184s
	iters: 500, epoch: 3 | loss: 0.0106047
	speed: 0.0658s/iter; left time: 511.6027s
	iters: 600, epoch: 3 | loss: 0.0110000
	speed: 0.0664s/iter; left time: 510.3505s
	iters: 700, epoch: 3 | loss: 0.0097705
	speed: 0.0663s/iter; left time: 502.3940s
	iters: 800, epoch: 3 | loss: 0.0074633
	speed: 0.0658s/iter; left time: 492.4474s
	iters: 900, epoch: 3 | loss: 0.0082464
	speed: 0.0661s/iter; left time: 488.0605s
	iters: 1000, epoch: 3 | loss: 0.0078156
	speed: 0.0661s/iter; left time: 481.0751s
Epoch: 3 cost time: 69.31716799736023
Epoch: 3, Steps: 1035 | Train Loss: 0.0102983 Vali Loss: 0.0065082 Test Loss: 0.0115230
Validation loss decreased (0.008625 --> 0.006508).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0092637
	speed: 0.2494s/iter; left time: 1782.5536s
	iters: 200, epoch: 4 | loss: 0.0100607
	speed: 0.0659s/iter; left time: 464.6259s
	iters: 300, epoch: 4 | loss: 0.0129083
	speed: 0.0663s/iter; left time: 460.6711s
	iters: 400, epoch: 4 | loss: 0.0087997
	speed: 0.0662s/iter; left time: 453.2416s
	iters: 500, epoch: 4 | loss: 0.0084460
	speed: 0.0665s/iter; left time: 448.3574s
	iters: 600, epoch: 4 | loss: 0.0076924
	speed: 0.0670s/iter; left time: 445.2092s
	iters: 700, epoch: 4 | loss: 0.0078013
	speed: 0.0665s/iter; left time: 435.5153s
	iters: 800, epoch: 4 | loss: 0.0084299
	speed: 0.0663s/iter; left time: 427.0826s
	iters: 900, epoch: 4 | loss: 0.0078526
	speed: 0.0674s/iter; left time: 427.7697s
	iters: 1000, epoch: 4 | loss: 0.0078442
	speed: 0.0669s/iter; left time: 417.9044s
Epoch: 4 cost time: 69.27733564376831
Epoch: 4, Steps: 1035 | Train Loss: 0.0086893 Vali Loss: 0.0055195 Test Loss: 0.0101109
Validation loss decreased (0.006508 --> 0.005519).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0069561
	speed: 0.2633s/iter; left time: 1608.7597s
	iters: 200, epoch: 5 | loss: 0.0080841
	speed: 0.0697s/iter; left time: 419.2300s
	iters: 300, epoch: 5 | loss: 0.0099508
	speed: 0.0697s/iter; left time: 412.0949s
	iters: 400, epoch: 5 | loss: 0.0077383
	speed: 0.0696s/iter; left time: 404.4278s
	iters: 500, epoch: 5 | loss: 0.0055898
	speed: 0.0688s/iter; left time: 392.9035s
	iters: 600, epoch: 5 | loss: 0.0106579
	speed: 0.0692s/iter; left time: 388.4723s
	iters: 700, epoch: 5 | loss: 0.0072166
	speed: 0.0695s/iter; left time: 383.2436s
	iters: 800, epoch: 5 | loss: 0.0075940
	speed: 0.0695s/iter; left time: 376.1937s
	iters: 900, epoch: 5 | loss: 0.0073723
	speed: 0.0695s/iter; left time: 369.3334s
	iters: 1000, epoch: 5 | loss: 0.0099571
	speed: 0.0708s/iter; left time: 369.1388s
Epoch: 5 cost time: 72.62583947181702
Epoch: 5, Steps: 1035 | Train Loss: 0.0079990 Vali Loss: 0.0050849 Test Loss: 0.0094584
Validation loss decreased (0.005519 --> 0.005085).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0059367
	speed: 0.2618s/iter; left time: 1328.9757s
	iters: 200, epoch: 6 | loss: 0.0075859
	speed: 0.0701s/iter; left time: 348.5836s
	iters: 300, epoch: 6 | loss: 0.0067145
	speed: 0.0694s/iter; left time: 338.3952s
	iters: 400, epoch: 6 | loss: 0.0072799
	speed: 0.0643s/iter; left time: 307.0241s
	iters: 500, epoch: 6 | loss: 0.0065242
	speed: 0.0656s/iter; left time: 306.5764s
	iters: 600, epoch: 6 | loss: 0.0077672
	speed: 0.0642s/iter; left time: 293.6363s
	iters: 700, epoch: 6 | loss: 0.0090805
	speed: 0.0678s/iter; left time: 303.3890s
	iters: 800, epoch: 6 | loss: 0.0104878
	speed: 0.0684s/iter; left time: 299.1265s
	iters: 900, epoch: 6 | loss: 0.0065547
	speed: 0.0687s/iter; left time: 293.6950s
	iters: 1000, epoch: 6 | loss: 0.0077984
	speed: 0.0703s/iter; left time: 293.5306s
Epoch: 6 cost time: 70.64774799346924
Epoch: 6, Steps: 1035 | Train Loss: 0.0076245 Vali Loss: 0.0048495 Test Loss: 0.0090962
Validation loss decreased (0.005085 --> 0.004850).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0062120
	speed: 0.2508s/iter; left time: 1013.3592s
	iters: 200, epoch: 7 | loss: 0.0079177
	speed: 0.0661s/iter; left time: 260.4781s
	iters: 300, epoch: 7 | loss: 0.0073131
	speed: 0.0663s/iter; left time: 254.8244s
	iters: 400, epoch: 7 | loss: 0.0078372
	speed: 0.0679s/iter; left time: 253.9931s
	iters: 500, epoch: 7 | loss: 0.0076163
	speed: 0.0663s/iter; left time: 241.3335s
	iters: 600, epoch: 7 | loss: 0.0080830
	speed: 0.0658s/iter; left time: 232.9386s
	iters: 700, epoch: 7 | loss: 0.0131571
	speed: 0.0658s/iter; left time: 226.4941s
	iters: 800, epoch: 7 | loss: 0.0090670
	speed: 0.0653s/iter; left time: 218.3292s
	iters: 900, epoch: 7 | loss: 0.0081642
	speed: 0.0663s/iter; left time: 214.9730s
	iters: 1000, epoch: 7 | loss: 0.0084724
	speed: 0.0667s/iter; left time: 209.4749s
Epoch: 7 cost time: 69.33748245239258
Epoch: 7, Steps: 1035 | Train Loss: 0.0074336 Vali Loss: 0.0047261 Test Loss: 0.0089068
Validation loss decreased (0.004850 --> 0.004726).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0084771
	speed: 0.2441s/iter; left time: 733.8202s
	iters: 200, epoch: 8 | loss: 0.0074825
	speed: 0.0656s/iter; left time: 190.5328s
	iters: 300, epoch: 8 | loss: 0.0070985
	speed: 0.0669s/iter; left time: 187.6123s
	iters: 400, epoch: 8 | loss: 0.0107589
	speed: 0.0665s/iter; left time: 180.0090s
	iters: 500, epoch: 8 | loss: 0.0071299
	speed: 0.0652s/iter; left time: 169.9401s
	iters: 600, epoch: 8 | loss: 0.0067457
	speed: 0.0660s/iter; left time: 165.2936s
	iters: 700, epoch: 8 | loss: 0.0061445
	speed: 0.0666s/iter; left time: 160.2434s
	iters: 800, epoch: 8 | loss: 0.0067507
	speed: 0.0659s/iter; left time: 151.8542s
	iters: 900, epoch: 8 | loss: 0.0053048
	speed: 0.0672s/iter; left time: 148.2002s
	iters: 1000, epoch: 8 | loss: 0.0061514
	speed: 0.0666s/iter; left time: 140.3559s
Epoch: 8 cost time: 69.0336799621582
Epoch: 8, Steps: 1035 | Train Loss: 0.0073292 Vali Loss: 0.0046405 Test Loss: 0.0087843
Validation loss decreased (0.004726 --> 0.004641).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0064615
	speed: 0.2541s/iter; left time: 500.9284s
	iters: 200, epoch: 9 | loss: 0.0061725
	speed: 0.0677s/iter; left time: 126.7379s
	iters: 300, epoch: 9 | loss: 0.0078430
	speed: 0.0672s/iter; left time: 119.0430s
	iters: 400, epoch: 9 | loss: 0.0073155
	speed: 0.0660s/iter; left time: 110.3070s
	iters: 500, epoch: 9 | loss: 0.0077156
	speed: 0.0661s/iter; left time: 103.7921s
	iters: 600, epoch: 9 | loss: 0.0056655
	speed: 0.0659s/iter; left time: 96.8889s
	iters: 700, epoch: 9 | loss: 0.0075087
	speed: 0.0632s/iter; left time: 86.6643s
	iters: 800, epoch: 9 | loss: 0.0088183
	speed: 0.0654s/iter; left time: 83.0641s
	iters: 900, epoch: 9 | loss: 0.0063165
	speed: 0.0664s/iter; left time: 77.7155s
	iters: 1000, epoch: 9 | loss: 0.0068299
	speed: 0.0660s/iter; left time: 70.6388s
Epoch: 9 cost time: 68.86403298377991
Epoch: 9, Steps: 1035 | Train Loss: 0.0072771 Vali Loss: 0.0046368 Test Loss: 0.0087477
Validation loss decreased (0.004641 --> 0.004637).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0074314
	speed: 0.2535s/iter; left time: 237.2739s
	iters: 200, epoch: 10 | loss: 0.0086955
	speed: 0.0659s/iter; left time: 55.1280s
	iters: 300, epoch: 10 | loss: 0.0076509
	speed: 0.0676s/iter; left time: 49.7250s
	iters: 400, epoch: 10 | loss: 0.0077188
	speed: 0.0655s/iter; left time: 41.6360s
	iters: 500, epoch: 10 | loss: 0.0072966
	speed: 0.0661s/iter; left time: 35.4127s
	iters: 600, epoch: 10 | loss: 0.0064947
	speed: 0.0663s/iter; left time: 28.9188s
	iters: 700, epoch: 10 | loss: 0.0058786
	speed: 0.0669s/iter; left time: 22.4775s
	iters: 800, epoch: 10 | loss: 0.0069495
	speed: 0.0665s/iter; left time: 15.6907s
	iters: 900, epoch: 10 | loss: 0.0070708
	speed: 0.0646s/iter; left time: 8.7855s
	iters: 1000, epoch: 10 | loss: 0.0098882
	speed: 0.0662s/iter; left time: 2.3815s
Epoch: 10 cost time: 68.86979031562805
Epoch: 10, Steps: 1035 | Train Loss: 0.0072523 Vali Loss: 0.0046114 Test Loss: 0.0087127
Validation loss decreased (0.004637 --> 0.004611).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>>>> Testing: PSM_TPATimesNet_TPATimesNet_PSM_anomaly_detection_ftM_sl100_dm64_nh8_el2_df64_PSM_Comparison_0 <<<<<<<<<<<<
test: (87841, 25)
train: (132481, 25)
test 87742
test: (87841, 25)
train: (132481, 25)
train 132382
Threshold: 0.038925942
pred:    (8774200,)
gt:      (8774200,)
Accuracy: 0.9850, Precision: 0.9844, Recall: 0.9612, F1-score: 0.9727

