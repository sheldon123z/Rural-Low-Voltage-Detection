# VoltageTimesNet_v2 超参数搜索进度

## 搜索配置
- **搜索方法**: Optuna TPE Sampler (multivariate=True)
- **总 Trial 数**: 30
- **训练 Epochs**: 5
- **数据集**: RuralVoltage/realistic_v2 (16 features)
- **开始时间**: 2026-02-03 10:48:13

## 搜索空间
| 参数 | 范围 |
|------|------|
| d_model | [32, 64, 128, 256] |
| e_layers | [1, 4] |
| d_ff | [32, 64, 128, 256, 512] |
| top_k | [2, 7] |
| num_kernels | [4, 6, 8] |
| lr | [1e-4, 1e-2] (log) |
| batch_size | [32, 64, 128] |
| dropout | [0.0, 0.3] |
| seq_len | [50, 100, 200] |
| anomaly_ratio | [1.5, 5.0] |

## Trial 结果

| Trial | d_model | e_layers | d_ff | top_k | num_kernels | lr | batch | dropout | seq_len | anom_ratio | Acc | Prec | Recall | F1 | Best? |
|:-----:|:-------:|:--------:|:----:|:-----:|:-----------:|:--:|:-----:|:-------:|:-------:|:----------:|:---:|:----:|:------:|:--:|:-----:|
| 0 | 64 | 1 | 128 | 2 | 4 | 2.31e-04 | 128 | 0.130 | 100 | 2.52 | 0.8707 | 0.5501 | 0.6766 | 0.6068 |  |
| 1 | 128 | 3 | 128 | 7 | 4 | 1.57e-04 | 32 | 0.149 | 100 | 3.82 | 0.8561 | 0.5069 | 0.8819 | 0.6438 |  |
| 2 | 128 | 4 | 64 | 2 | 8 | 5.99e-04 | 64 | 0.084 | 200 | 1.76 | 0.8978 | 0.6524 | 0.6725 | 0.6623 |  |
| 3 | 32 | 4 | 128 | 2 | 4 | 1.34e-04 | 128 | 0.191 | 50 | 4.00 | 0.8641 | 0.5195 | 0.9782 | 0.6786 |  |
| 4 | 128 | 3 | 512 | 3 | 6 | 6.62e-04 | 32 | 0.087 | 100 | 3.72 | 0.8561 | 0.5072 | 0.8533 | 0.6362 |  |
| 5 | 256 | 3 | 64 | 4 | 6 | 1.05e-03 | 32 | 0.101 | 50 | 3.96 | 0.8646 | 0.5201 | 0.9916 | 0.6824 |  |
| 6 | 64 | 2 | 256 | 2 | 6 | 1.95e-04 | 64 | 0.202 | 50 | 2.79 | 0.9183 | 0.6543 | 0.9390 | 0.7712 |  |
| 7 | 64 | 4 | 512 | 2 | 8 | 2.23e-04 | 128 | 0.041 | 200 | 4.57 | 0.7914 | 0.4030 | 0.8323 | 0.5431 |  |
| 8 | 128 | 3 | 256 | 4 | 8 | 5.95e-03 | 32 | 0.048 | 50 | 1.86 | 0.9361 | 0.7431 | 0.8632 | 0.7987 |  |
| 9 | 32 | 3 | 128 | 6 | 6 | 1.37e-03 | 64 | 0.073 | 50 | 3.71 | 0.8795 | 0.5501 | 0.9810 | 0.7049 |  |
| **10** | 128 | 3 | 256 | 2 | 8 | 4.19e-03 | 32 | 0.017 | 50 | 2.08 | 0.9393 | 0.7371 | 0.9110 | **0.8149** | **★** |
| 11 | 128 | 3 | 32 | 2 | 8 | 6.15e-03 | 32 | 0.057 | 50 | 2.89 | 0.9139 | 0.6392 | 0.9484 | 0.7637 |  |
| 12 | 64 | 4 | 128 | 4 | 6 | 1.87e-03 | 32 | 0.047 | 50 | 1.84 | 0.9352 | 0.7413 | 0.8574 | 0.7952 |  |
| 13 | 128 | 3 | 256 | 5 | 8 | 4.22e-03 | 128 | 0.070 | 50 | 1.52 | 0.9203 | 0.7363 | 0.7120 | 0.7239 |  |
| 14 | 128 | 4 | 256 | 3 | 8 | 2.88e-03 | 32 | 0.045 | 100 | 1.54 | 0.9047 | 0.6793 | 0.6707 | 0.6750 |  |
| 15 | 128 | 1 | 64 | 3 | 4 | 5.29e-03 | 32 | 0.066 | 50 | 1.57 | 0.9328 | 0.7566 | 0.7985 | 0.7770 |  |
| 16 | 128 | 2 | 128 | 2 | 8 | 9.24e-04 | 32 | 0.162 | 50 | 1.76 | 0.9275 | 0.7339 | 0.7938 | 0.7627 |  |
| 17 | 128 | 3 | 32 | 5 | 6 | 3.82e-03 | 32 | 0.009 | 200 | 1.92 | 0.8888 | 0.6153 | 0.6771 | 0.6447 |  |
| 18 | 32 | 3 | 256 | 3 | 8 | 4.42e-03 | 64 | 0.004 | 50 | 2.65 | 0.9254 | 0.6782 | 0.9352 | 0.7862 |  |
| 19 | 128 | 3 | 256 | 3 | 8 | 5.34e-04 | 32 | 0.009 | 50 | 2.83 | 0.9195 | 0.6543 | 0.9569 | 0.7772 |  |
| 20 | 256 | 2 | 256 | 2 | 8 | 4.42e-03 | 32 | 0.070 | 200 | 2.73 | 0.8490 | 0.4952 | 0.6901 | 0.5766 |  |
| 21 | 64 | 4 | 256 | 6 | 6 | 6.11e-03 | 32 | 0.090 | 50 | 1.87 | 0.9230 | 0.7159 | 0.7883 | 0.7503 |  |
| 22 | 64 | 4 | 128 | 4 | 6 | 9.64e-04 | 32 | 0.076 | 50 | 1.78 | 0.9162 | 0.7097 | 0.7260 | 0.7178 |  |
| 23 | 128 | 2 | 256 | 2 | 8 | 9.99e-03 | 32 | 0.055 | 50 | 2.25 | 0.9354 | 0.7205 | 0.9143 | 0.8059 |  |
| 24 | 128 | 2 | 256 | 3 | 8 | 7.26e-03 | 32 | 0.090 | 50 | 1.84 | 0.9286 | 0.7335 | 0.8068 | 0.7684 |  |
| 25 | 128 | 2 | 128 | 2 | 8 | 7.02e-03 | 32 | 0.022 | 200 | 2.23 | 0.8721 | 0.5581 | 0.6806 | 0.6133 |  |
| 26 | 64 | 1 | 256 | 2 | 8 | 8.21e-03 | 128 | 0.008 | 50 | 1.88 | 0.9257 | 0.7224 | 0.8013 | 0.7598 |  |
| 27 | 128 | 2 | 256 | 2 | 6 | 9.95e-03 | 32 | 0.096 | 100 | 2.79 | 0.8674 | 0.5373 | 0.7251 | 0.6172 |  |
| 28 | 256 | 4 | 256 | 2 | 8 | 9.32e-03 | 32 | 0.097 | 50 | 2.69 | 0.9236 | 0.6713 | 0.9394 | 0.7830 |  |
| 29 | 32 | 3 | 256 | 2 | 6 | 5.41e-03 | 32 | 0.093 | 50 | 2.11 | 0.9218 | 0.7023 | 0.8104 | 0.7525 |  |

## 当前最佳配置 (Trial 10)
```json
{
  "d_model": 128,
  "e_layers": 3,
  "d_ff": 256,
  "top_k": 2,
  "num_kernels": 8,
  "lr": 0.004187634328282308,
  "batch_size": 32,
  "dropout": 0.017205487272539746,
  "seq_len": 50,
  "anomaly_ratio": 2.0848233172051147,
  "f1_score": 0.8149,
  "recall": 0.9110,
  "precision": 0.7371,
  "accuracy": 0.9393
}
```

## 关键发现

- **seq_len 分布**: 50=20次(最佳F1=0.8149), 100=5次(最佳F1=0.6750), 200=5次(最佳F1=0.6623)
- **d_model 最佳F1**: 32=0.7862, 64=0.7952, 128=0.8149, 256=0.7830

## 与之前最佳对比
| 指标 | 之前最佳 (3 trials) | 当前最佳 (Trial 10) | 变化 |
|------|:-------------------:|:------------------:|:----:|
| F1 | 0.7649 | 0.8149 | +5.0% |
| Recall | 0.9631 | 0.9110 | -5.2% |
| Precision | 0.6343 | 0.7371 | 10.3% |
| Accuracy | 0.9131 | 0.9393 | 2.6% |

## 搜索进度
- **已完成**: 30/30 (100%)
- **当前状态**: ✅ 完成
- **最后更新**: 2026-02-03 20:29:55
