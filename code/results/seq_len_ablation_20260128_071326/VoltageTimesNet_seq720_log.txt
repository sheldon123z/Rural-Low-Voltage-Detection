Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           ablation_seqlen_VoltageTimesNet_720Model:              VoltageTimesNet     

[1mData Loader[0m
  Data:               RuralVoltage        Root Path:          ./dataset/RuralVoltage/comprehensive
  Features:           M                   Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Seq Len:            720                 Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             16                  C Out:              16                  
  d model:            64                  d FF:               64                  
  n heads:            8                   e layers:           2                   
  Dropout:            0.1                 Embed:              timeF               

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

Use GPU: cuda:0
>>>>>>>>>> Training: ablation_seqlen_VoltageTimesNet_720_VoltageTimesNet_RuralVoltage_anomaly_detection_ftM_sl720_dm64_nh8_el2_df64_test_0 <<<<<<<<<<<<
RuralVoltage Dataset loaded:
  - Features: 16 (Va, Vb, Vc, Ia, Ib...)
  - Train: (20000, 16)
  - Test: (6000, 16)
  - Val: (4000, 16)
train 19281
RuralVoltage Dataset loaded:
  - Features: 16 (Va, Vb, Vc, Ia, Ib...)
  - Train: (20000, 16)
  - Test: (6000, 16)
  - Val: (4000, 16)
val 3281
RuralVoltage Dataset loaded:
  - Features: 16 (Va, Vb, Vc, Ia, Ib...)
  - Train: (20000, 16)
  - Test: (6000, 16)
  - Val: (4000, 16)
test 5281
	iters: 100, epoch: 1 | loss: 0.4957441
	speed: 0.1120s/iter; left time: 664.1200s
	iters: 200, epoch: 1 | loss: 0.1585940
	speed: 0.0972s/iter; left time: 566.8784s
	iters: 300, epoch: 1 | loss: 0.0859686
	speed: 0.0981s/iter; left time: 562.0715s
	iters: 400, epoch: 1 | loss: 0.0655013
	speed: 0.0978s/iter; left time: 550.4340s
	iters: 500, epoch: 1 | loss: 0.0569424
	speed: 0.0977s/iter; left time: 540.5355s
	iters: 600, epoch: 1 | loss: 0.0512306
	speed: 0.0980s/iter; left time: 532.3320s
Epoch: 1 cost time: 59.035738706588745
Epoch: 1, Steps: 603 | Train Loss: 0.2407243 Vali Loss: 0.0157917 Test Loss: 0.3917760
Validation loss decreased (inf --> 0.015792).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0473338
	speed: 0.2219s/iter; left time: 1182.0535s
	iters: 200, epoch: 2 | loss: 0.0442700
	speed: 0.0981s/iter; left time: 513.0265s
	iters: 300, epoch: 2 | loss: 0.0427846
	speed: 0.0976s/iter; left time: 500.7295s
	iters: 400, epoch: 2 | loss: 0.0403254
	speed: 0.0981s/iter; left time: 493.2382s
	iters: 500, epoch: 2 | loss: 0.0391007
	speed: 0.0974s/iter; left time: 479.8420s
	iters: 600, epoch: 2 | loss: 0.0376820
	speed: 0.0978s/iter; left time: 472.2894s
Epoch: 2 cost time: 59.65532183647156
Epoch: 2, Steps: 603 | Train Loss: 0.0430341 Vali Loss: 0.0083930 Test Loss: 0.3193311
Validation loss decreased (0.015792 --> 0.008393).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0367929
	speed: 0.2177s/iter; left time: 1028.7174s
	iters: 200, epoch: 3 | loss: 0.0363671
	speed: 0.0978s/iter; left time: 452.3661s
	iters: 300, epoch: 3 | loss: 0.0363081
	speed: 0.0984s/iter; left time: 445.2116s
	iters: 400, epoch: 3 | loss: 0.0354000
	speed: 0.0978s/iter; left time: 432.7341s
	iters: 500, epoch: 3 | loss: 0.0347163
	speed: 0.0983s/iter; left time: 425.3251s
	iters: 600, epoch: 3 | loss: 0.0344289
	speed: 0.0982s/iter; left time: 414.8281s
Epoch: 3 cost time: 59.65280556678772
Epoch: 3, Steps: 603 | Train Loss: 0.0360012 Vali Loss: 0.0067621 Test Loss: 0.3034709
Validation loss decreased (0.008393 --> 0.006762).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0343465
	speed: 0.2132s/iter; left time: 878.7257s
	iters: 200, epoch: 4 | loss: 0.0341588
	speed: 0.0973s/iter; left time: 391.1570s
	iters: 300, epoch: 4 | loss: 0.0339963
	speed: 0.0980s/iter; left time: 384.3966s
	iters: 400, epoch: 4 | loss: 0.0334291
	speed: 0.0976s/iter; left time: 373.1116s
	iters: 500, epoch: 4 | loss: 0.0335177
	speed: 0.0970s/iter; left time: 360.9603s
	iters: 600, epoch: 4 | loss: 0.0332909
	speed: 0.0978s/iter; left time: 354.3449s
Epoch: 4 cost time: 59.33737111091614
Epoch: 4, Steps: 603 | Train Loss: 0.0339152 Vali Loss: 0.0060493 Test Loss: 0.2913075
Validation loss decreased (0.006762 --> 0.006049).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0328749
	speed: 0.2143s/iter; left time: 754.1927s
	iters: 200, epoch: 5 | loss: 0.0331647
	speed: 0.0973s/iter; left time: 332.5436s
	iters: 300, epoch: 5 | loss: 0.0326824
	speed: 0.0980s/iter; left time: 325.2252s
	iters: 400, epoch: 5 | loss: 0.0328085
	speed: 0.0983s/iter; left time: 316.2694s
	iters: 500, epoch: 5 | loss: 0.0327359
	speed: 0.0978s/iter; left time: 305.1738s
	iters: 600, epoch: 5 | loss: 0.0327834
	speed: 0.0979s/iter; left time: 295.4769s
Epoch: 5 cost time: 59.49145555496216
Epoch: 5, Steps: 603 | Train Loss: 0.0329333 Vali Loss: 0.0057091 Test Loss: 0.2872370
Validation loss decreased (0.006049 --> 0.005709).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0324524
	speed: 0.2160s/iter; left time: 629.7819s
	iters: 200, epoch: 6 | loss: 0.0322595
	speed: 0.0995s/iter; left time: 280.2473s
	iters: 300, epoch: 6 | loss: 0.0325739
	speed: 0.0979s/iter; left time: 266.0261s
	iters: 400, epoch: 6 | loss: 0.0323148
	speed: 0.0976s/iter; left time: 255.2328s
	iters: 500, epoch: 6 | loss: 0.0322622
	speed: 0.0975s/iter; left time: 245.2793s
	iters: 600, epoch: 6 | loss: 0.0322785
	speed: 0.0980s/iter; left time: 236.7185s
Epoch: 6 cost time: 59.54555916786194
Epoch: 6, Steps: 603 | Train Loss: 0.0324267 Vali Loss: 0.0054830 Test Loss: 0.2829012
Validation loss decreased (0.005709 --> 0.005483).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0319163
	speed: 0.2175s/iter; left time: 503.0544s
	iters: 200, epoch: 7 | loss: 0.0323555
	speed: 0.0974s/iter; left time: 215.5216s
	iters: 300, epoch: 7 | loss: 0.0320748
	speed: 0.0973s/iter; left time: 205.6220s
	iters: 400, epoch: 7 | loss: 0.0323545
	speed: 0.0978s/iter; left time: 196.8894s
	iters: 500, epoch: 7 | loss: 0.0322020
	speed: 0.0973s/iter; left time: 186.1591s
	iters: 600, epoch: 7 | loss: 0.0322961
	speed: 0.0982s/iter; left time: 178.0845s
Epoch: 7 cost time: 59.33604288101196
Epoch: 7, Steps: 603 | Train Loss: 0.0321311 Vali Loss: 0.0053720 Test Loss: 0.2818700
Validation loss decreased (0.005483 --> 0.005372).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0320361
	speed: 0.2176s/iter; left time: 372.1334s
	iters: 200, epoch: 8 | loss: 0.0321924
	speed: 0.0980s/iter; left time: 157.8145s
	iters: 300, epoch: 8 | loss: 0.0319492
	speed: 0.0976s/iter; left time: 147.4100s
	iters: 400, epoch: 8 | loss: 0.0318374
	speed: 0.0983s/iter; left time: 138.6600s
	iters: 500, epoch: 8 | loss: 0.0319535
	speed: 0.0977s/iter; left time: 127.9981s
	iters: 600, epoch: 8 | loss: 0.0321936
	speed: 0.0962s/iter; left time: 116.4176s
Epoch: 8 cost time: 59.54827833175659
Epoch: 8, Steps: 603 | Train Loss: 0.0319600 Vali Loss: 0.0053041 Test Loss: 0.2804894
Validation loss decreased (0.005372 --> 0.005304).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0318451
	speed: 0.2165s/iter; left time: 239.6429s
	iters: 200, epoch: 9 | loss: 0.0318444
	speed: 0.0974s/iter; left time: 98.0451s
	iters: 300, epoch: 9 | loss: 0.0317378
	speed: 0.0983s/iter; left time: 89.1160s
	iters: 400, epoch: 9 | loss: 0.0321814
	speed: 0.0967s/iter; left time: 78.0683s
	iters: 500, epoch: 9 | loss: 0.0319160
	speed: 0.0979s/iter; left time: 69.2143s
	iters: 600, epoch: 9 | loss: 0.0319423
	speed: 0.0976s/iter; left time: 59.2726s
Epoch: 9 cost time: 59.40903997421265
Epoch: 9, Steps: 603 | Train Loss: 0.0318500 Vali Loss: 0.0052533 Test Loss: 0.2796895
Validation loss decreased (0.005304 --> 0.005253).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0315325
	speed: 0.1917s/iter; left time: 96.6105s
	iters: 200, epoch: 10 | loss: 0.0312855
	speed: 0.0888s/iter; left time: 35.8776s
	iters: 300, epoch: 10 | loss: 0.0317480
	speed: 0.0967s/iter; left time: 29.3967s
	iters: 400, epoch: 10 | loss: 0.0318080
	speed: 0.0968s/iter; left time: 19.7546s
	iters: 500, epoch: 10 | loss: 0.0318409
	speed: 0.0962s/iter; left time: 10.0006s
	iters: 600, epoch: 10 | loss: 0.0315948
	speed: 0.0971s/iter; left time: 0.3883s
Epoch: 10 cost time: 56.712502002716064
Epoch: 10, Steps: 603 | Train Loss: 0.0318069 Vali Loss: 0.0052315 Test Loss: 0.2792842
Validation loss decreased (0.005253 --> 0.005232).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>>>> Testing: ablation_seqlen_VoltageTimesNet_720_VoltageTimesNet_RuralVoltage_anomaly_detection_ftM_sl720_dm64_nh8_el2_df64_test_0 <<<<<<<<<<<<
RuralVoltage Dataset loaded:
  - Features: 16 (Va, Vb, Vc, Ia, Ib...)
  - Train: (20000, 16)
  - Test: (6000, 16)
  - Val: (4000, 16)
test 5281
RuralVoltage Dataset loaded:
  - Features: 16 (Va, Vb, Vc, Ia, Ib...)
  - Train: (20000, 16)
  - Test: (6000, 16)
  - Val: (4000, 16)
train 19281
Threshold: 1.252459
pred:    (3802320,)
gt:      (3802320,)
Accuracy: 0.8730, Precision: 0.9930, Recall: 0.7507, F1-score: 0.8550
