# 可解释性分析 - 写作材料

> **生成时间**: 2026-01-27
> **用途**: 论文第三章"算法设计"补充可解释性分析小节

---

## 一、建议添加位置

在第三章末尾（如 3.5 节或 3.6 节），添加"异常检测结果的可解释性分析"小节。

这一部分与第三章 3.1.2 节"基于重构的异常检测原理"相呼应，详细说明如何利用重构误差进行异常解释。

---

## 二、写作内容

### 2.1 小节标题

```latex
\section{异常检测结果的可解释性分析}
```

### 2.2 引言段落

```latex
深度学习模型的可解释性是工业应用中的重要考量。本节阐述如何基于TimesNet的重构机制对异常检测结果进行解释，包括特征维度重要性分析、异常模式可视化和典型案例分析，以增强模型的可信度和实用价值。
```

---

### 2.3 基于重构误差的特征重要性分析

```latex
\subsection{基于重构误差的特征重要性分析}

TimesNet采用重构误差作为异常分数，这一机制天然具有特征级可解释性。设原始输入为$\mathbf{X} \in \mathbb{R}^{T \times C}$，重构输出为$\hat{\mathbf{X}} \in \mathbb{R}^{T \times C}$，特征$c$在时刻$t$的重构误差为：
\begin{equation}
	e_{t,c} = (x_{t,c} - \hat{x}_{t,c})^2
\end{equation}

\textbf{特征重要性度量}：通过分析各特征维度的平均重构误差，可以识别对异常检测贡献最大的特征：
\begin{equation}
	\text{Importance}_c = \frac{1}{|\mathcal{A}|}\sum_{t \in \mathcal{A}} e_{t,c}
\end{equation}
其中$\mathcal{A}$为检测到的异常时间点集合。

对于RuralVoltage数据集的16维特征，特征重要性排序为：
\begin{enumerate}
	\item \textbf{三相电压（Va, Vb, Vc）}：对欠压、过压、电压骤降异常最敏感
	\item \textbf{电压不平衡度（V\_unbalance）}：三相不平衡异常的关键指标
	\item \textbf{谐波畸变率（THD\_Va/b/c）}：谐波畸变异常的直接指标
	\item \textbf{三相电流（Ia, Ib, Ic）}：反映负荷异常，与电压异常间接相关
\end{enumerate}

这一分析表明，模型学习到的特征重要性与电压异常的物理机理一致，增强了检测结果的可信度。
```

---

### 2.4 异常模式可视化

```latex
\subsection{异常模式可视化}

重构误差序列可直观展示异常的时间分布和严重程度。设总重构误差为：
\begin{equation}
	e_t = \frac{1}{C}\sum_{c=1}^{C} e_{t,c}
\end{equation}

\textbf{异常定位}：通过重构误差时序图，运维人员可快速定位异常发生的时间窗口。异常通常表现为重构误差的局部峰值，峰值高度反映异常严重程度。

\textbf{异常类型判别}：结合特征维度分解，可进一步判别异常类型：
\begin{itemize}
	\item 若$e_{t,Va}$、$e_{t,Vb}$、$e_{t,Vc}$同时显著增大，可能为系统性过压/欠压
	\item 若仅单相电压误差增大，可能为单相故障或三相不平衡
	\item 若THD相关特征误差显著，可能为谐波畸变
\end{itemize}

\textbf{可视化展示}：图\ref{fig:error_visualization}展示了典型的重构误差可视化示例，上半部分为原始电压序列，下半部分为重构误差及异常检测结果（阴影区域表示检测到的异常段）。

% 注：此图需要生成
% \begin{figure}[htbp]
%     \centering
%     \includegraphics[width=0.9\textwidth]{figures/chap3/重构误差可视化.png}
%     \caption{重构误差与异常检测可视化示例}
%     \label{fig:error_visualization}
% \end{figure}
```

---

### 2.5 典型案例分析

```latex
\subsection{典型案例分析}

本节通过RuralVoltage数据集中的典型案例，说明模型对不同类型电压异常的检测和解释能力。

\subsubsection{案例一：电压骤降（Voltage Sag）}

电压骤降是农村电网最常见的异常类型之一，通常由负荷突变、短路故障或电网切换引起。

\textbf{异常特征}：三相电压在短时间内（通常0.5秒至1分钟）下降超过10\%，随后恢复正常。

\textbf{模型响应}：
\begin{itemize}
	\item 重构误差在骤降开始时刻急剧上升
	\item Va、Vb、Vc三个通道的误差同步增大
	\item 误差峰值与骤降幅度成正相关
	\item 骤降结束后，误差迅速回落至正常水平
\end{itemize}

\textbf{可解释性说明}：模型学习的是正常电压模式，骤降期间的低电压无法被正确重构，产生较大误差。误差的时间分布与真实骤降区间高度吻合，验证了检测的准确性。

\subsubsection{案例二：谐波畸变（Harmonic Distortion）}

谐波畸变通常由非线性负荷（如变频器、整流器）引起，表现为电压波形的失真。

\textbf{异常特征}：总谐波畸变率THD超过国标规定的5\%，电压波形出现高频叠加分量。

\textbf{模型响应}：
\begin{itemize}
	\item THD\_Va、THD\_Vb、THD\_Vc通道的重构误差显著增大
	\item 电压通道也出现一定程度的误差增加（因波形畸变）
	\item 误差呈现持续性特征，与谐波持续时间一致
\end{itemize}

\textbf{可解释性说明}：模型对正常的正弦波形建模良好，但难以准确重构含有高次谐波的畸变波形。THD通道的高误差直接指向谐波问题，便于运维人员快速定位故障源。

\subsubsection{案例三：三相不平衡（Three-phase Unbalance）}

三相不平衡在单相负荷为主的农村电网中较为常见，可能导致设备损坏和电能质量下降。

\textbf{异常特征}：三相电压幅值或相位差偏离平衡状态，不平衡度超过国标规定的2\%。

\textbf{模型响应}：
\begin{itemize}
	\item V\_unbalance通道的重构误差显著增大
	\item 三相电压通道呈现差异化的误差分布
	\item 负荷较重相的电压通道误差更大
\end{itemize}

\textbf{可解释性说明}：模型学习了三相平衡的正常模式，不平衡状态下的三相差异无法被准确重构。V\_unbalance通道的高误差直接反映不平衡程度，三相电压通道的差异化误差有助于定位问题相别。
```

---

### 2.6 小节总结

```latex
\subsection{本节小结}

本节从三个维度阐述了TimesNet异常检测结果的可解释性：

\textbf{特征级解释}：通过分析各特征维度的重构误差，识别对异常贡献最大的特征，所得特征重要性排序与电压异常的物理机理一致。

\textbf{时序级解释}：重构误差序列直观展示异常的时间分布和严重程度，支持异常的快速定位和趋势分析。

\textbf{案例级解释}：通过典型案例分析，展示模型对不同类型电压异常（骤降、谐波、不平衡）的检测机理和解释能力。

这些可解释性特征使TimesNet不仅能检测异常，还能为运维人员提供诊断依据，具有重要的工程应用价值。
```

---

## 三、配套图表建议

### 3.1 需要生成的图表

| 图表 | 文件名建议 | 内容描述 |
|------|-----------|---------|
| 特征重要性柱状图 | `特征重要性分析.png` | 16维特征的平均重构误差对比 |
| 重构误差可视化 | `重构误差可视化.png` | 原始序列+重构序列+误差+异常区域 |
| 电压骤降案例 | `案例_电压骤降.png` | 骤降前后的电压波形和误差 |
| 谐波畸变案例 | `案例_谐波畸变.png` | 正常vs畸变波形对比 |
| 三相不平衡案例 | `案例_三相不平衡.png` | 三相电压差异和不平衡度 |

### 3.2 图表生成脚本位置

建议将图表生成脚本放在 `thesis/figures/chap3/` 或 `code/scripts/visualization/` 目录。

---

## 四、与现有内容的衔接

### 4.1 与 3.1.2 节的关联

第 3.1.2 节"基于重构的异常检测原理"已介绍重构误差的基本概念（公式 3.1 和 3.2）。可解释性分析是对这一原理的深化应用：

```latex
% 在新小节开头可添加如下衔接语
如3.1.2节所述，重构误差$e_t$（式\ref{eq:reconstruction_error}）是异常检测的核心度量。本节进一步阐述如何利用这一度量对检测结果进行多维度解释。
```

### 4.2 与第四章的关联

第四章实验部分可引用可解释性分析的结论：

```latex
% 在第四章实验分析中可添加
如第三章所述，模型的可解释性分析表明，三相电压通道对检测结果贡献最大，这与电压异常的物理机理一致。
```

---

## 五、注意事项

1. **数据支撑**：案例分析最好基于真实实验数据，可从测试集中选取典型样本
2. **图表美观**：使用论文规范的配色和字体
3. **术语一致**：与前文使用的术语保持一致（如"重构误差"而非"reconstruction error"）
4. **篇幅控制**：建议 1.5-2 页，避免过度展开

---

## 六、LaTeX 代码完整版

以下是可直接插入 `chap02.tex` 的完整代码：

```latex
\section{异常检测结果的可解释性分析}

深度学习模型的可解释性是工业应用中的重要考量。本节阐述如何基于TimesNet的重构机制对异常检测结果进行解释，包括特征维度重要性分析、异常模式可视化和典型案例分析，以增强模型的可信度和实用价值。

\subsection{基于重构误差的特征重要性分析}

TimesNet采用重构误差作为异常分数，这一机制天然具有特征级可解释性。设原始输入为$\mathbf{X} \in \mathbb{R}^{T \times C}$，重构输出为$\hat{\mathbf{X}} \in \mathbb{R}^{T \times C}$，特征$c$在时刻$t$的重构误差为：
\begin{equation}
	e_{t,c} = (x_{t,c} - \hat{x}_{t,c})^2
\end{equation}

通过分析各特征维度的平均重构误差，可以识别对异常检测贡献最大的特征：
\begin{equation}
	\text{Importance}_c = \frac{1}{|\mathcal{A}|}\sum_{t \in \mathcal{A}} e_{t,c}
\end{equation}
其中$\mathcal{A}$为检测到的异常时间点集合。

对于RuralVoltage数据集的16维特征，特征重要性排序为：（1）三相电压（Va、Vb、Vc）对欠压、过压、电压骤降异常最敏感；（2）电压不平衡度（V\_unbalance）是三相不平衡异常的关键指标；（3）谐波畸变率（THD\_Va/b/c）是谐波畸变异常的直接指标；（4）三相电流（Ia、Ib、Ic）反映负荷异常，与电压异常间接相关。这一分析表明，模型学习到的特征重要性与电压异常的物理机理一致，增强了检测结果的可信度。

\subsection{异常模式可视化}

重构误差序列可直观展示异常的时间分布和严重程度。设总重构误差为$e_t = \frac{1}{C}\sum_{c=1}^{C} e_{t,c}$。通过重构误差时序图，运维人员可快速定位异常发生的时间窗口，异常通常表现为重构误差的局部峰值，峰值高度反映异常严重程度。

结合特征维度分解，可进一步判别异常类型：若Va、Vb、Vc三相电压通道的误差同时显著增大，可能为系统性过压或欠压；若仅单相电压误差增大，可能为单相故障或三相不平衡；若THD相关特征误差显著，可能为谐波畸变。这种特征级分解为故障诊断提供了直接依据。

\subsection{典型案例分析}

以下通过RuralVoltage数据集中的典型案例说明模型的检测和解释能力。

\textbf{电压骤降案例}：电压骤降通常由负荷突变或短路故障引起，表现为三相电压在短时间内下降超过10\%后恢复正常。模型响应表现为重构误差在骤降时刻急剧上升，三相电压通道的误差同步增大，骤降结束后误差迅速回落。这表明模型准确捕获了骤降的时间边界。

\textbf{谐波畸变案例}：谐波畸变由非线性负荷引起，表现为THD超过5\%。模型响应表现为THD相关通道的重构误差显著增大，误差呈现持续性特征，与谐波持续时间一致。THD通道的高误差直接指向谐波问题，便于定位故障源。

\textbf{三相不平衡案例}：三相不平衡在单相负荷为主的农村电网中较为常见。模型响应表现为V\_unbalance通道误差显著增大，三相电压通道呈现差异化的误差分布。这种差异化分布有助于定位问题相别。

\subsection{本节小结}

本节从特征级、时序级和案例级三个维度阐述了TimesNet异常检测结果的可解释性。特征重要性分析揭示了各维度对检测的贡献，与电压异常的物理机理一致；时序级分析支持异常的快速定位；案例分析展示了模型对不同异常类型的检测机理。这些可解释性特征使模型不仅能检测异常，还能为运维人员提供诊断依据，具有重要的工程应用价值。
```

---

*写作材料生成于 2026-01-27*
