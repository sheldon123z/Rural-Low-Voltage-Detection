name: Documentation

on:
  push:
    branches: [ main, develop ]
    paths:
      - '**.md'
      - 'thesis/**'
      - '.github/workflows/documentation.yml'
  pull_request:
    branches: [ main, develop ]
    paths:
      - '**.md'
      - 'thesis/**'

jobs:
  markdown-lint:
    name: Markdown Linting
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Lint markdown files
      uses: DavidAnson/markdownlint-cli2-action@v15
      with:
        globs: |
          README.md
          CLAUDE.md
          code/voltage_anomaly_detection/README.md
          code/voltage_anomaly_detection/EXPERIMENT_PLAN.md
      continue-on-error: true
      
  check-links:
    name: Check Documentation Links
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check links in markdown files
      uses: gaurav-nelson/github-action-markdown-link-check@v1
      with:
        use-quiet-mode: 'yes'
        config-file: '.github/markdown-link-check-config.json'
      continue-on-error: true
      
  latex-check:
    name: LaTeX Thesis Check
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check LaTeX files exist
      run: |
        if [ -d "thesis" ]; then
          echo "✓ Thesis directory found"
          find thesis -name "*.tex" | head -10
        else
          echo "No thesis directory found"
        fi
        
    - name: Summary
      if: always()
      run: |
        echo "### Documentation Check Complete ✓" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "- Markdown linting completed" >> $GITHUB_STEP_SUMMARY
        echo "- Link validation completed" >> $GITHUB_STEP_SUMMARY
        echo "- LaTeX structure validated" >> $GITHUB_STEP_SUMMARY
